"use strict";(globalThis.webpackChunkphysical_ai_humanoid_robotics_book=globalThis.webpackChunkphysical_ai_humanoid_robotics_book||[]).push([[954],{5230(n,e,i){i.r(e),i.d(e,{assets:()=>l,contentTitle:()=>t,default:()=>m,frontMatter:()=>r,metadata:()=>s,toc:()=>c});var o=i(4848),a=i(8453);const r={sidebar_position:6,title:"Chapter 6: Gazebo Simulation Environment Setup"},t="Chapter 6: Gazebo Simulation Environment Setup",s={id:"part3/chapter6",title:"Chapter 6: Gazebo Simulation Environment Setup",description:"Learning Objectives",source:"@site/docs/part3/chapter6.md",sourceDirName:"part3",slug:"/part3/chapter6",permalink:"/Physical-AI-Humanoid-Robotics/docs/part3/chapter6",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/part3/chapter6.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6,title:"Chapter 6: Gazebo Simulation Environment Setup"},sidebar:"tutorialSidebar",previous:{title:"Chapter 5: ROS 2 Nodes, Topics, and Services",permalink:"/Physical-AI-Humanoid-Robotics/docs/part2/chapter5"},next:{title:"Chapter 7: URDF and SDF Robot Description Formats",permalink:"/Physical-AI-Humanoid-Robotics/docs/part3/chapter7"}},l={},c=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Introduction to Gazebo Simulation",id:"introduction-to-gazebo-simulation",level:2},{value:"Why Gazebo for Humanoid Robotics?",id:"why-gazebo-for-humanoid-robotics",level:3},{value:"Gazebo Architecture",id:"gazebo-architecture",level:3},{value:"Installing and Setting Up Gazebo",id:"installing-and-setting-up-gazebo",level:2},{value:"System Requirements",id:"system-requirements",level:3},{value:"Installation Process",id:"installation-process",level:3},{value:"Verification",id:"verification",level:3},{value:"Physics Simulation Principles",id:"physics-simulation-principles",level:2},{value:"Understanding Physics Engines",id:"understanding-physics-engines",level:3},{value:"ODE (Open Dynamics Engine)",id:"ode-open-dynamics-engine",level:4},{value:"Bullet Physics",id:"bullet-physics",level:4},{value:"DART (Dynamic Animation and Robotics Toolkit)",id:"dart-dynamic-animation-and-robotics-toolkit",level:4},{value:"Physics Configuration in SDF",id:"physics-configuration-in-sdf",level:3},{value:"Key Physics Parameters",id:"key-physics-parameters",level:3},{value:"Time Step Configuration",id:"time-step-configuration",level:4},{value:"Gravity and Environmental Forces",id:"gravity-and-environmental-forces",level:4},{value:"Contact Properties",id:"contact-properties",level:4},{value:"Creating Simulation Environments",id:"creating-simulation-environments",level:2},{value:"Basic World File Structure",id:"basic-world-file-structure",level:3},{value:"Creating Custom Models",id:"creating-custom-models",level:3},{value:"ROS 2 Integration with Gazebo",id:"ros-2-integration-with-gazebo",level:2},{value:"Launching Gazebo with ROS 2",id:"launching-gazebo-with-ros-2",level:3},{value:"Robot Control in Simulation",id:"robot-control-in-simulation",level:3},{value:"Launching Controllers",id:"launching-controllers",level:3},{value:"Advanced Simulation Techniques",id:"advanced-simulation-techniques",level:2},{value:"Dynamic Environment Objects",id:"dynamic-environment-objects",level:3},{value:"Terrain and Complex Environments",id:"terrain-and-complex-environments",level:3},{value:"Simulation Workflows",id:"simulation-workflows",level:2},{value:"Training vs. Testing Environments",id:"training-vs-testing-environments",level:3},{value:"Training Configuration",id:"training-configuration",level:4},{value:"Testing Configuration",id:"testing-configuration",level:4},{value:"Multi-Robot Simulation",id:"multi-robot-simulation",level:3},{value:"Performance Optimization",id:"performance-optimization",level:2},{value:"Simulation Performance Tips",id:"simulation-performance-tips",level:3},{value:"Resource Management",id:"resource-management",level:3},{value:"Troubleshooting Common Issues",id:"troubleshooting-common-issues",level:2},{value:"Physics Instability",id:"physics-instability",level:3},{value:"Joint Limits and Control",id:"joint-limits-and-control",level:3},{value:"Knowledge Check",id:"knowledge-check",level:2},{value:"Summary",id:"summary",level:2},{value:"Next Steps",id:"next-steps",level:2}];function d(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.h1,{id:"chapter-6-gazebo-simulation-environment-setup",children:"Chapter 6: Gazebo Simulation Environment Setup"}),"\n",(0,o.jsx)(e.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"Set up Gazebo simulation environment for humanoid robotics"}),"\n",(0,o.jsx)(e.li,{children:"Understand physics simulation principles and their importance"}),"\n",(0,o.jsx)(e.li,{children:"Configure realistic physics properties for humanoid robots"}),"\n",(0,o.jsx)(e.li,{children:"Integrate Gazebo with ROS 2 for robot simulation and control"}),"\n"]}),"\n",(0,o.jsx)(e.h2,{id:"introduction-to-gazebo-simulation",children:"Introduction to Gazebo Simulation"}),"\n",(0,o.jsx)(e.p,{children:'Gazebo is a powerful 3D simulation environment that provides realistic physics simulation, high-quality graphics, and convenient programmatic interfaces. For humanoid robotics, Gazebo serves as a "digital twin" that allows for safe testing, algorithm development, and validation before deploying on real hardware.'}),"\n",(0,o.jsx)(e.h3,{id:"why-gazebo-for-humanoid-robotics",children:"Why Gazebo for Humanoid Robotics?"}),"\n",(0,o.jsx)(e.p,{children:"Gazebo is particularly well-suited for humanoid robotics because:"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Realistic Physics"}),": Accurate simulation of gravity, friction, collisions, and dynamics"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Sensor Simulation"}),": Realistic simulation of cameras, LIDAR, IMUs, and force/torque sensors"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Complex Environments"}),": Creation of realistic indoor and outdoor environments"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Hardware Integration"}),": Seamless integration with ROS 2 through Gazebo ROS packages"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Safety"}),": Risk-free testing of complex behaviors without hardware damage"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Cost-Effective"}),": No need for expensive physical prototypes"]}),"\n"]}),"\n",(0,o.jsx)(e.h3,{id:"gazebo-architecture",children:"Gazebo Architecture"}),"\n",(0,o.jsx)(e.p,{children:"Gazebo follows a client-server architecture:"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Gazebo Server"}),": Runs the physics simulation and handles all simulation logic"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Gazebo Client"}),": Provides the graphical user interface for visualization"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Plugins"}),": Extend functionality through custom code (physics, sensors, controllers)"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"ROS 2 Interface"}),": Bridges simulation to ROS 2 topics and services"]}),"\n"]}),"\n",(0,o.jsx)(e.h2,{id:"installing-and-setting-up-gazebo",children:"Installing and Setting Up Gazebo"}),"\n",(0,o.jsx)(e.h3,{id:"system-requirements",children:"System Requirements"}),"\n",(0,o.jsx)(e.p,{children:"Before installing Gazebo, ensure your system meets the requirements:"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Operating System"}),": Ubuntu 22.04 LTS (recommended) or similar Linux distribution"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Graphics"}),": GPU with OpenGL 2.1+ support (for GUI)"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"RAM"}),": 8GB+ recommended for complex simulations"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Storage"}),": 10GB+ for Gazebo models and environments"]}),"\n"]}),"\n",(0,o.jsx)(e.h3,{id:"installation-process",children:"Installation Process"}),"\n",(0,o.jsx)(e.p,{children:"For ROS 2 Humble Hawksbill (Ubuntu 22.04):"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-bash",children:"# Install Gazebo Garden (recommended for ROS 2 Humble)\nsudo apt update\nsudo apt install ros-humble-gazebo-ros-pkgs ros-humble-gazebo-ros2-control\n\n# Install additional dependencies\nsudo apt install gazebo\n"})}),"\n",(0,o.jsx)(e.h3,{id:"verification",children:"Verification"}),"\n",(0,o.jsx)(e.p,{children:"Test the installation:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-bash",children:"# Launch Gazebo GUI\ngazebo\n\n# Launch Gazebo server only (no GUI)\ngzserver\n\n# Launch Gazebo client only (connects to running server)\ngzclient\n"})}),"\n",(0,o.jsx)(e.h2,{id:"physics-simulation-principles",children:"Physics Simulation Principles"}),"\n",(0,o.jsx)(e.h3,{id:"understanding-physics-engines",children:"Understanding Physics Engines"}),"\n",(0,o.jsx)(e.p,{children:"Gazebo supports multiple physics engines, each with different characteristics:"}),"\n",(0,o.jsx)(e.h4,{id:"ode-open-dynamics-engine",children:"ODE (Open Dynamics Engine)"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"Default physics engine for Gazebo"}),"\n",(0,o.jsx)(e.li,{children:"Good balance of performance and accuracy"}),"\n",(0,o.jsx)(e.li,{children:"Suitable for most humanoid robotics applications"}),"\n",(0,o.jsx)(e.li,{children:"Supports complex contact dynamics"}),"\n"]}),"\n",(0,o.jsx)(e.h4,{id:"bullet-physics",children:"Bullet Physics"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"High-performance physics engine"}),"\n",(0,o.jsx)(e.li,{children:"Good for real-time applications"}),"\n",(0,o.jsx)(e.li,{children:"Excellent collision detection"}),"\n",(0,o.jsx)(e.li,{children:"Good for humanoid balance simulation"}),"\n"]}),"\n",(0,o.jsx)(e.h4,{id:"dart-dynamic-animation-and-robotics-toolkit",children:"DART (Dynamic Animation and Robotics Toolkit)"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"Advanced physics simulation"}),"\n",(0,o.jsx)(e.li,{children:"Better handling of complex contacts"}),"\n",(0,o.jsx)(e.li,{children:"Excellent for humanoid locomotion"}),"\n",(0,o.jsx)(e.li,{children:"More accurate than ODE for complex interactions"}),"\n"]}),"\n",(0,o.jsx)(e.h3,{id:"physics-configuration-in-sdf",children:"Physics Configuration in SDF"}),"\n",(0,o.jsx)(e.p,{children:"The Simulation Description Format (SDF) allows configuration of physics properties:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<sdf version="1.7">\n  <world name="humanoid_world">\n    \x3c!-- Physics engine configuration --\x3e\n    <physics type="ode" name="default_physics">\n      <max_step_size>0.001</max_step_size>\n      <real_time_factor>1.0</real_time_factor>\n      <real_time_update_rate>1000.0</real_time_update_rate>\n      <gravity>0 0 -9.8</gravity>\n\n      \x3c!-- ODE-specific parameters --\x3e\n      <ode>\n        <solver>\n          <type>quick</type>\n          <iters>10</iters>\n          <sor>1.3</sor>\n        </solver>\n        <constraints>\n          <cfm>0.0</cfm>\n          <erp>0.2</erp>\n          <contact_max_correcting_vel>100.0</contact_max_correcting_vel>\n          <contact_surface_layer>0.001</contact_surface_layer>\n        </constraints>\n      </ode>\n    </physics>\n\n    \x3c!-- World content --\x3e\n    <include>\n      <uri>model://ground_plane</uri>\n    </include>\n\n    <include>\n      <uri>model://sun</uri>\n    </include>\n  </world>\n</sdf>\n'})}),"\n",(0,o.jsx)(e.h3,{id:"key-physics-parameters",children:"Key Physics Parameters"}),"\n",(0,o.jsx)(e.h4,{id:"time-step-configuration",children:"Time Step Configuration"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-xml",children:"<max_step_size>0.001</max_step_size>  \x3c!-- Simulation time step (seconds) --\x3e\n<real_time_factor>1.0</real_time_factor>  \x3c!-- Simulation speed multiplier --\x3e\n<real_time_update_rate>1000.0</real_time_update_rate>  \x3c!-- Hz --\x3e\n"})}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"Best practices for humanoid robots:"})}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"Use smaller time steps (0.001s or smaller) for stability"}),"\n",(0,o.jsx)(e.li,{children:"Balance accuracy with performance requirements"}),"\n",(0,o.jsx)(e.li,{children:"Consider real-time factor for training vs. testing scenarios"}),"\n"]}),"\n",(0,o.jsx)(e.h4,{id:"gravity-and-environmental-forces",children:"Gravity and Environmental Forces"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-xml",children:"<gravity>0 0 -9.8</gravity>  \x3c!-- Standard Earth gravity --\x3e\n"})}),"\n",(0,o.jsx)(e.p,{children:"For humanoid balance testing, you might want to adjust gravity:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-xml",children:"<gravity>0 0 -1.62</gravity>  \x3c!-- Moon gravity for stability testing --\x3e\n"})}),"\n",(0,o.jsx)(e.h4,{id:"contact-properties",children:"Contact Properties"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-xml",children:"<contact_max_correcting_vel>100.0</contact_max_correcting_vel>  \x3c!-- Max contact velocity --\x3e\n<contact_surface_layer>0.001</contact_surface_layer>  \x3c!-- Surface layer thickness --\x3e\n"})}),"\n",(0,o.jsx)(e.h2,{id:"creating-simulation-environments",children:"Creating Simulation Environments"}),"\n",(0,o.jsx)(e.h3,{id:"basic-world-file-structure",children:"Basic World File Structure"}),"\n",(0,o.jsx)(e.p,{children:"A Gazebo world file is an SDF file that defines the simulation environment:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<sdf version="1.7">\n  <world name="humanoid_lab">\n    \x3c!-- Physics configuration --\x3e\n    <physics type="ode" name="default_physics">\n      <max_step_size>0.001</max_step_size>\n      <real_time_factor>1.0</real_time_factor>\n      <real_time_update_rate>1000.0</real_time_update_rate>\n      <gravity>0 0 -9.8</gravity>\n    </physics>\n\n    \x3c!-- Models in the environment --\x3e\n    <include>\n      <uri>model://ground_plane</uri>\n    </include>\n\n    <include>\n      <uri>model://sun</uri>\n    </include>\n\n    \x3c!-- Custom environment objects --\x3e\n    <model name="table">\n      <pose>2 0 0.5 0 0 0</pose>\n      <link name="table_link">\n        <collision name="collision">\n          <geometry>\n            <box>\n              <size>1.0 0.8 0.8</size>\n            </box>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <box>\n              <size>1.0 0.8 0.8</size>\n            </box>\n          </geometry>\n          <material>\n            <ambient>0.8 0.6 0.4 1</ambient>\n            <diffuse>0.8 0.6 0.4 1</diffuse>\n          </material>\n        </visual>\n        <inertial>\n          <mass>50.0</mass>\n          <inertia>\n            <ixx>5.0</ixx>\n            <ixy>0.0</ixy>\n            <ixz>0.0</ixz>\n            <iyy>5.0</iyy>\n            <iyz>0.0</iyz>\n            <izz>5.0</izz>\n          </inertia>\n        </inertial>\n      </link>\n    </model>\n\n    \x3c!-- Lighting --\x3e\n    <light name="room_light" type="point">\n      <pose>0 0 3 0 0 0</pose>\n      <diffuse>1 1 1 1</diffuse>\n      <specular>0.5 0.5 0.5 1</specular>\n      <attenuation>\n        <range>10</range>\n        <constant>0.5</constant>\n        <linear>0.1</linear>\n        <quadratic>0.01</quadratic>\n      </attenuation>\n    </light>\n  </world>\n</sdf>\n'})}),"\n",(0,o.jsx)(e.h3,{id:"creating-custom-models",children:"Creating Custom Models"}),"\n",(0,o.jsx)(e.p,{children:"To create a custom humanoid robot model for Gazebo, extend your URDF with Gazebo-specific tags:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<robot name="humanoid_robot" xmlns:xacro="http://www.ros.org/wiki/xacro">\n  \x3c!-- Include main URDF content --\x3e\n  <xacro:include filename="humanoid.urdf"/>\n\n  \x3c!-- Gazebo-specific plugins and configurations --\x3e\n  <gazebo>\n    <plugin name="gazebo_ros_control" filename="libgazebo_ros_control.so">\n      <robotNamespace>/humanoid_robot</robotNamespace>\n      <robotSimType>gazebo_ros_control/DefaultRobotHWSim</robotSimType>\n    </plugin>\n  </gazebo>\n\n  \x3c!-- Ground truth pose publisher --\x3e\n  <gazebo>\n    <plugin name="p3d_base_controller" filename="libgazebo_ros_p3d.so">\n      <alwaysOn>true</alwaysOn>\n      <updateRate>100.0</updateRate>\n      <bodyName>base_link</bodyName>\n      <topicName>ground_truth/state</topicName>\n      <gaussianNoise>0.01</gaussianNoise>\n      <frameName>map</frameName>\n    </plugin>\n  </gazebo>\n\n  \x3c!-- IMU sensor plugin --\x3e\n  <gazebo reference="imu_link">\n    <sensor name="imu_sensor" type="imu">\n      <always_on>true</always_on>\n      <update_rate>100</update_rate>\n      <visualize>true</visualize>\n      <imu>\n        <angular_velocity>\n          <x>\n            <noise type="gaussian">\n              <mean>0.0</mean>\n              <stddev>0.02</stddev>\n            </noise>\n          </x>\n          <y>\n            <noise type="gaussian">\n              <mean>0.0</mean>\n              <stddev>0.02</stddev>\n            </noise>\n          </y>\n          <z>\n            <noise type="gaussian">\n              <mean>0.0</mean>\n              <stddev>0.02</stddev>\n            </noise>\n          </z>\n        </angular_velocity>\n        <linear_acceleration>\n          <x>\n            <noise type="gaussian">\n              <mean>0.0</mean>\n              <stddev>0.17</stddev>\n            </noise>\n          </x>\n          <y>\n            <noise type="gaussian">\n              <mean>0.0</mean>\n              <stddev>0.17</stddev>\n            </noise>\n          </y>\n          <z>\n            <noise type="gaussian">\n              <mean>0.0</mean>\n              <stddev>0.17</stddev>\n            </noise>\n          </z>\n        </linear_acceleration>\n      </imu>\n    </sensor>\n  </gazebo>\n\n  \x3c!-- Camera sensor plugin --\x3e\n  <gazebo reference="camera_link">\n    <sensor name="camera" type="camera">\n      <always_on>true</always_on>\n      <update_rate>30.0</update_rate>\n      <camera name="head">\n        <horizontal_fov>1.3962634</horizontal_fov>\n        <image>\n          <width>640</width>\n          <height>480</height>\n          <format>R8G8B8</format>\n        </image>\n        <clip>\n          <near>0.1</near>\n          <far>100</far>\n        </clip>\n      </camera>\n      <plugin name="camera_controller" filename="libgazebo_ros_camera.so">\n        <frame_name>camera_optical_frame</frame_name>\n        <min_depth>0.1</min_depth>\n        <max_depth>100.0</max_depth>\n      </plugin>\n    </sensor>\n  </gazebo>\n\n  \x3c!-- LIDAR sensor plugin --\x3e\n  <gazebo reference="lidar_link">\n    <sensor name="laser" type="ray">\n      <always_on>true</always_on>\n      <visualize>true</visualize>\n      <update_rate>10</update_rate>\n      <ray>\n        <scan>\n          <horizontal>\n            <samples>720</samples>\n            <resolution>1</resolution>\n            <min_angle>-3.14159</min_angle>\n            <max_angle>3.14159</max_angle>\n          </horizontal>\n        </scan>\n        <range>\n          <min>0.10</min>\n          <max>30.0</max>\n          <resolution>0.01</resolution>\n        </range>\n      </ray>\n      <plugin name="laser_controller" filename="libgazebo_ros_laser.so">\n        <frame_name>lidar_link</frame_name>\n      </plugin>\n    </sensor>\n  </gazebo>\n</robot>\n'})}),"\n",(0,o.jsx)(e.h2,{id:"ros-2-integration-with-gazebo",children:"ROS 2 Integration with Gazebo"}),"\n",(0,o.jsx)(e.h3,{id:"launching-gazebo-with-ros-2",children:"Launching Gazebo with ROS 2"}),"\n",(0,o.jsx)(e.p,{children:"Create a launch file to start Gazebo with your robot:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-python",children:"# launch/humanoid_gazebo.launch.py\nfrom launch import LaunchDescription\nfrom launch.actions import DeclareLaunchArgument, IncludeLaunchDescription\nfrom launch.launch_description_sources import PythonLaunchDescriptionSource\nfrom launch.substitutions import LaunchConfiguration, PathJoinSubstitution\nfrom launch_ros.actions import Node\nfrom launch_ros.substitutions import FindPackageShare\n\ndef generate_launch_description():\n    # Declare launch arguments\n    world_arg = DeclareLaunchArgument(\n        'world',\n        default_value='humanoid_lab.sdf',\n        description='Choose one of the world files from `/my_robot_gazebo/worlds`'\n    )\n\n    # Launch Gazebo\n    gazebo = IncludeLaunchDescription(\n        PythonLaunchDescriptionSource([\n            PathJoinSubstitution([\n                FindPackageShare('gazebo_ros'),\n                'launch',\n                'gazebo.launch.py'\n            ])\n        ]),\n        launch_arguments={\n            'world': PathJoinSubstitution([\n                FindPackageShare('my_robot_gazebo'),\n                'worlds',\n                LaunchConfiguration('world')\n            ])\n        }.items()\n    )\n\n    # Spawn robot in Gazebo\n    spawn_entity = Node(\n        package='gazebo_ros',\n        executable='spawn_entity.py',\n        arguments=[\n            '-topic', 'robot_description',\n            '-entity', 'humanoid_robot',\n            '-x', '0.0',\n            '-y', '0.0',\n            '-z', '1.0'\n        ],\n        output='screen'\n    )\n\n    # Robot state publisher\n    robot_state_publisher = Node(\n        package='robot_state_publisher',\n        executable='robot_state_publisher',\n        name='robot_state_publisher',\n        output='screen',\n        parameters=[{\n            'use_sim_time': True,\n            'robot_description': Command(['xacro ', PathJoinSubstitution([\n                FindPackageShare('my_robot_description'),\n                'urdf',\n                'humanoid.urdf.xacro'\n            ])])\n        }]\n    )\n\n    return LaunchDescription([\n        world_arg,\n        robot_state_publisher,\n        gazebo,\n        spawn_entity\n    ])\n"})}),"\n",(0,o.jsx)(e.h3,{id:"robot-control-in-simulation",children:"Robot Control in Simulation"}),"\n",(0,o.jsx)(e.p,{children:"To control your robot in Gazebo, you need to set up ROS 2 controllers. Create a controller configuration file:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-yaml",children:"# config/humanoid_controllers.yaml\ncontroller_manager:\n  ros__parameters:\n    update_rate: 100  # Hz\n\n    joint_state_controller:\n      type: joint_state_controller/JointStateController\n\n    left_leg_controller:\n      type: position_controllers/JointGroupPositionController\n      joints:\n        - left_hip\n        - left_knee\n        - left_ankle\n\n    right_leg_controller:\n      type: position_controllers/JointGroupPositionController\n      joints:\n        - right_hip\n        - right_knee\n        - right_ankle\n\n    left_arm_controller:\n      type: position_controllers/JointGroupPositionController\n      joints:\n        - left_shoulder\n        - left_elbow\n\n    right_arm_controller:\n      type: position_controllers/JointGroupPositionController\n      joints:\n        - right_shoulder\n        - right_elbow\n\n    head_controller:\n      type: position_controllers/JointGroupPositionController\n      joints:\n        - head_pan\n        - head_tilt\n"})}),"\n",(0,o.jsx)(e.h3,{id:"launching-controllers",children:"Launching Controllers"}),"\n",(0,o.jsx)(e.p,{children:"Create a launch file to start the controllers:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-python",children:'# launch/humanoid_control.launch.py\nfrom launch import LaunchDescription\nfrom launch.actions import RegisterEventHandler\nfrom launch.event_handlers import OnProcessStart\nfrom launch.substitutions import Command, FindExecutable, PathJoinSubstitution\nfrom launch_ros.actions import Node\nfrom launch_ros.substitutions import FindPackageShare\n\ndef generate_launch_description():\n    # Get URDF via xacro\n    robot_description_content = Command(\n        [\n            PathJoinSubstitution([FindExecutable(name="xacro")]),\n            " ",\n            PathJoinSubstitution([\n                FindPackageShare("my_robot_description"),\n                "urdf",\n                "humanoid.urdf.xacro",\n            ]),\n        ]\n    )\n    robot_description = {"robot_description": robot_description_content}\n\n    # Robot state publisher\n    robot_state_publisher = Node(\n        package="robot_state_publisher",\n        executable="robot_state_publisher",\n        output="both",\n        parameters=[robot_description],\n    )\n\n    # Spawn controllers\n    joint_state_broadcaster_spawner = Node(\n        package="controller_manager",\n        executable="spawner",\n        arguments=["joint_state_controller", "-c", "/controller_manager"],\n    )\n\n    left_leg_controller_spawner = Node(\n        package="controller_manager",\n        executable="spawner",\n        arguments=["left_leg_controller", "-c", "/controller_manager"],\n    )\n\n    right_leg_controller_spawner = Node(\n        package="controller_manager",\n        executable="spawner",\n        arguments=["right_leg_controller", "-c", "/controller_manager"],\n    )\n\n    left_arm_controller_spawner = Node(\n        package="controller_manager",\n        executable="spawner",\n        arguments=["left_arm_controller", "-c", "/controller_manager"],\n    )\n\n    right_arm_controller_spawner = Node(\n        package="controller_manager",\n        executable="spawner",\n        arguments=["right_arm_controller", "-c", "/controller_manager"],\n    )\n\n    head_controller_spawner = Node(\n        package="controller_manager",\n        executable="spawner",\n        arguments=["head_controller", "-c", "/controller_manager"],\n    )\n\n    # Return launch description\n    return LaunchDescription([\n        robot_state_publisher,\n        joint_state_broadcaster_spawner,\n        left_leg_controller_spawner,\n        right_leg_controller_spawner,\n        left_arm_controller_spawner,\n        right_arm_controller_spawner,\n        head_controller_spawner,\n    ])\n'})}),"\n",(0,o.jsx)(e.h2,{id:"advanced-simulation-techniques",children:"Advanced Simulation Techniques"}),"\n",(0,o.jsx)(e.h3,{id:"dynamic-environment-objects",children:"Dynamic Environment Objects"}),"\n",(0,o.jsx)(e.p,{children:"Create dynamic objects that interact with your robot:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<sdf version="1.7">\n  <model name="movable_box">\n    <pose>3 0 0.5 0 0 0</pose>\n    <link name="box_link">\n      <collision name="collision">\n        <geometry>\n          <box>\n            <size>0.2 0.2 0.2</size>\n          </box>\n        </geometry>\n      </collision>\n      <visual name="visual">\n        <geometry>\n          <box>\n            <size>0.2 0.2 0.2</size>\n          </box>\n        </geometry>\n        <material>\n          <ambient>0.8 0.4 0.2 1</ambient>\n          <diffuse>0.8 0.4 0.2 1</diffuse>\n        </material>\n      </visual>\n      <inertial>\n        <mass>1.0</mass>\n        <inertia>\n          <ixx>0.0083</ixx>\n          <ixy>0.0</ixy>\n          <ixz>0.0</ixz>\n          <iyy>0.0083</iyy>\n          <iyz>0.0</iyz>\n          <izz>0.0083</izz>\n        </inertia>\n      </inertial>\n    </link>\n\n    \x3c!-- Allow the object to be grasped by the robot --\x3e\n    <plugin name="gazebo_ros_grasp_fix" filename="libgazebo_ros_grasp_fix.so">\n      <arm>\n        <arm_name>left_arm</arm_name>\n        <collision_name>box::box_link::collision</collision_name>\n      </arm>\n    </plugin>\n  </model>\n</sdf>\n'})}),"\n",(0,o.jsx)(e.h3,{id:"terrain-and-complex-environments",children:"Terrain and Complex Environments"}),"\n",(0,o.jsx)(e.p,{children:"For humanoid locomotion training, create challenging terrains:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<sdf version="1.7">\n  <world name="challenging_terrain">\n    <physics type="ode">\n      <max_step_size>0.001</max_step_size>\n      <real_time_factor>1.0</real_time_factor>\n      <real_time_update_rate>1000.0</real_time_update_rate>\n      <gravity>0 0 -9.8</gravity>\n    </physics>\n\n    \x3c!-- Ground plane with texture --\x3e\n    <model name="ground_plane">\n      <static>true</static>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <plane>\n              <normal>0 0 1</normal>\n              <size>100 100</size>\n            </plane>\n          </geometry>\n          <surface>\n            <friction>\n              <ode>\n                <mu>1.0</mu>\n                <mu2>1.0</mu2>\n              </ode>\n            </friction>\n          </surface>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <plane>\n              <normal>0 0 1</normal>\n              <size>100 100</size>\n            </plane>\n          </geometry>\n          <material>\n            <script>\n              <uri>file://media/materials/scripts/gazebo.material</uri>\n              <name>Gazebo/Grass</name>\n            <\/script>\n          </material>\n        </visual>\n        <self_collide>0</self_collide>\n        <kinematic>0</kinematic>\n        <gravity>1</gravity>\n      </link>\n    </model>\n\n    \x3c!-- Obstacles for navigation --\x3e\n    <model name="obstacle_1">\n      <pose>5 0 0.5 0 0 0</pose>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <box>\n              <size>0.5 0.5 1.0</size>\n            </box>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <box>\n              <size>0.5 0.5 1.0</size>\n            </box>\n          </geometry>\n          <material>\n            <ambient>0.5 0.5 0.5 1</ambient>\n            <diffuse>0.5 0.5 0.5 1</diffuse>\n          </material>\n        </visual>\n        <inertial>\n          <mass>10.0</mass>\n          <inertia>\n            <ixx>1.0</ixx>\n            <ixy>0.0</ixy>\n            <ixz>0.0</ixz>\n            <iyy>1.0</iyy>\n            <iyz>0.0</iyz>\n            <izz>1.0</izz>\n          </inertia>\n        </inertial>\n      </link>\n    </model>\n\n    \x3c!-- Stairs for locomotion training --\x3e\n    <model name="stairs">\n      <pose>8 0 0 0 0 0</pose>\n      <link name="base_link">\n        <collision name="collision">\n          <geometry>\n            <mesh>\n              <uri>file://meshes/stairs.dae</uri>\n            </mesh>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <mesh>\n              <uri>file://meshes/stairs.dae</uri>\n            </mesh>\n          </geometry>\n        </visual>\n        <inertial>\n          <mass>100.0</mass>\n          <inertia>\n            <ixx>100.0</ixx>\n            <ixy>0.0</ixy>\n            <ixz>0.0</ixz>\n            <iyy>100.0</iyy>\n            <iyz>0.0</iyz>\n            <izz>100.0</izz>\n          </inertia>\n        </inertial>\n      </link>\n    </model>\n  </world>\n</sdf>\n'})}),"\n",(0,o.jsx)(e.h2,{id:"simulation-workflows",children:"Simulation Workflows"}),"\n",(0,o.jsx)(e.h3,{id:"training-vs-testing-environments",children:"Training vs. Testing Environments"}),"\n",(0,o.jsx)(e.p,{children:"Different simulation configurations are needed for training versus testing:"}),"\n",(0,o.jsx)(e.h4,{id:"training-configuration",children:"Training Configuration"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-xml",children:'\x3c!-- Training environment: Simplified physics, faster simulation --\x3e\n<physics type="ode" name="training_physics">\n  <max_step_size>0.01</max_step_size>  \x3c!-- Larger steps for speed --\x3e\n  <real_time_factor>5.0</real_time_factor>  \x3c!-- 5x faster than real-time --\x3e\n  <real_time_update_rate>100.0</real_time_update_rate>\n  <gravity>0 0 -9.8</gravity>\n  <ode>\n    <solver>\n      <type>quick</type>\n      <iters>20</iters>  \x3c!-- Fewer iterations for speed --\x3e\n      <sor>1.3</sor>\n    </solver>\n  </ode>\n</physics>\n'})}),"\n",(0,o.jsx)(e.h4,{id:"testing-configuration",children:"Testing Configuration"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-xml",children:'\x3c!-- Testing environment: Accurate physics, realistic simulation --\x3e\n<physics type="ode" name="testing_physics">\n  <max_step_size>0.001</max_step_size>  \x3c!-- Smaller steps for accuracy --\x3e\n  <real_time_factor>1.0</real_time_factor>  \x3c!-- Real-time simulation --\x3e\n  <real_time_update_rate>1000.0</real_time_update_rate>\n  <gravity>0 0 -9.8</gravity>\n  <ode>\n    <solver>\n      <type>quick</type>\n      <iters>100</iters>  \x3c!-- More iterations for accuracy --\x3e\n      <sor>1.0</sor>\n    </solver>\n  </ode>\n</physics>\n'})}),"\n",(0,o.jsx)(e.h3,{id:"multi-robot-simulation",children:"Multi-Robot Simulation"}),"\n",(0,o.jsx)(e.p,{children:"Simulate multiple robots in the same environment:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<sdf version="1.7">\n  <world name="multi_robot_world">\n    \x3c!-- Physics configuration --\x3e\n    <physics type="ode">\n      <max_step_size>0.001</max_step_size>\n      <real_time_factor>1.0</real_time_factor>\n      <real_time_update_rate>1000.0</real_time_update_rate>\n    </physics>\n\n    \x3c!-- Robot 1 --\x3e\n    <include>\n      <name>humanoid_robot_1</name>\n      <uri>model://humanoid_robot</uri>\n      <pose>0 0 1 0 0 0</pose>\n    </include>\n\n    \x3c!-- Robot 2 --\x3e\n    <include>\n      <name>humanoid_robot_2</name>\n      <uri>model://humanoid_robot</uri>\n      <pose>2 0 1 0 0 0</pose>\n    </include>\n\n    \x3c!-- Communication between robots --\x3e\n    <gazebo>\n      <plugin name="multi_robot_communication" filename="libmulti_robot_comm.so">\n        <robot_namespace>/humanoid_robot_1</robot_namespace>\n        <robot_namespace>/humanoid_robot_2</robot_namespace>\n        <communication_range>10.0</communication_range>\n      </plugin>\n    </gazebo>\n  </world>\n</sdf>\n'})}),"\n",(0,o.jsx)(e.h2,{id:"performance-optimization",children:"Performance Optimization"}),"\n",(0,o.jsx)(e.h3,{id:"simulation-performance-tips",children:"Simulation Performance Tips"}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Adjust Time Step"}),": Balance accuracy vs. performance"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Limit Physics Iterations"}),": Fewer iterations = faster simulation"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Use Simplified Models"}),": Lower polygon count for visual meshes"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Optimize Collision Geometry"}),": Use simpler shapes for collision detection"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Reduce Update Rates"}),": Lower sensor update rates where possible"]}),"\n"]}),"\n",(0,o.jsx)(e.h3,{id:"resource-management",children:"Resource Management"}),"\n",(0,o.jsx)(e.p,{children:"Monitor simulation performance:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-bash",children:"# Monitor Gazebo server performance\nhtop -p $(pgrep gzserver)\n\n# Monitor physics update rate\ngz stats\n\n# Check for bottlenecks\nros2 topic hz /clock  # Should match real_time_update_rate\n"})}),"\n",(0,o.jsx)(e.h2,{id:"troubleshooting-common-issues",children:"Troubleshooting Common Issues"}),"\n",(0,o.jsx)(e.h3,{id:"physics-instability",children:"Physics Instability"}),"\n",(0,o.jsx)(e.p,{children:"If your humanoid robot is unstable in simulation:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-xml",children:"\x3c!-- Increase constraint solver iterations --\x3e\n<ode>\n  <solver>\n    <iters>200</iters>  \x3c!-- Increase from default --\x3e\n    <sor>1.0</sor>      \x3c!-- Lower for stability --\x3e\n  </solver>\n  <constraints>\n    <contact_surface_layer>0.005</contact_surface_layer>  \x3c!-- Increase slightly --\x3e\n    <contact_max_correcting_vel>10.0</contact_max_correcting_vel>\n  </constraints>\n</ode>\n"})}),"\n",(0,o.jsx)(e.h3,{id:"joint-limits-and-control",children:"Joint Limits and Control"}),"\n",(0,o.jsx)(e.p,{children:"Ensure proper joint limits in URDF:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-xml",children:'<joint name="left_knee" type="revolute">\n  <parent link="left_upper_leg"/>\n  <child link="left_lower_leg"/>\n  <origin xyz="0 0 -0.4" rpy="0 0 0"/>\n  <axis xyz="0 1 0"/>\n  <limit lower="-2.36" upper="0.785" effort="100" velocity="2"/>  \x3c!-- Proper limits --\x3e\n  <dynamics damping="1.0" friction="0.1"/>  \x3c!-- Add damping for stability --\x3e\n</joint>\n'})}),"\n",(0,o.jsx)(e.h2,{id:"knowledge-check",children:"Knowledge Check"}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsx)(e.li,{children:"What are the key physics parameters that affect humanoid robot simulation stability?"}),"\n",(0,o.jsx)(e.li,{children:"How do you configure different physics settings for training vs. testing environments?"}),"\n",(0,o.jsx)(e.li,{children:"What are the essential Gazebo plugins needed for humanoid robot simulation?"}),"\n",(0,o.jsx)(e.li,{children:"How do you integrate Gazebo with ROS 2 controllers?"}),"\n"]}),"\n",(0,o.jsx)(e.h2,{id:"summary",children:"Summary"}),"\n",(0,o.jsx)(e.p,{children:"This chapter covered the setup and configuration of Gazebo simulation environment for humanoid robotics. We explored physics simulation principles, world creation, ROS 2 integration, and advanced simulation techniques. The chapter also provided practical examples for creating realistic environments and optimizing simulation performance for humanoid robot applications."}),"\n",(0,o.jsx)(e.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,o.jsx)(e.p,{children:"In the next chapter, we'll explore URDF and SDF robot description formats in more detail, learning how to create complex robot models and configure physics properties for simulation."})]})}function m(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(d,{...n})}):d(n)}},8453(n,e,i){i.d(e,{R:()=>t,x:()=>s});var o=i(6540);const a={},r=o.createContext(a);function t(n){const e=o.useContext(r);return o.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:t(n.components),o.createElement(r.Provider,{value:e},n.children)}}}]);